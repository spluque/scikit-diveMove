
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Bout analysis &#8212; skdiveMove 0.3.2.post2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script src="../_static/documentation_options.js?v=ecd569df"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'demos/demo_bouts';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Simulating bouts" href="demo_simulbouts.html" />
    <link rel="prev" title="Diving behaviour analysis" href="demo_tdr.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="https://raw.githubusercontent.com/spluque/scikit-diveMove/master/docs/source/.static/skdiveMove_logo_1line.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="https://raw.githubusercontent.com/spluque/scikit-diveMove/master/docs/source/.static/skdiveMove_logo_1line.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Demos
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../modules/index.html">
                        Modules
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/spluque/scikit-diveMove" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Demos
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../modules/index.html">
                        Modules
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/spluque/scikit-diveMove" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="demo_tdr.html">Diving behaviour analysis</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Bout analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo_simulbouts.html">Simulating bouts</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="imutools_demos.html">Working with tri-axial IMUs</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="demo_imu2body.html">IMU-frame to body-frame transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="demo_allan.html">Allan deviation analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="demo_ellipsoid.html">Ellipsoid modelling for calibration purposes</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Demos</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Bout analysis</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="bout-analysis">
<span id="demo-bouts-label"></span><h1>Bout analysis<a class="headerlink" href="#bout-analysis" title="Link to this heading">#</a></h1>
<p>Here is a brief demo on bout analysis with the <a class="reference internal" href="../modules/bouts.html#module-bouts" title="bouts"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bouts</span></code></a> module for
data generated by mixtures of random Poisson processes.</p>
<p>Set up the environment.  Consider loading the <a class="reference external" href="https://docs.python.org/3/library/logging.html#module-logging" title="(in Python v3.12)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">logging</span></code></a> module and
setting up a logger to monitor progress to this section.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1"># Set up</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">importlib.resources</span> <span class="k">as</span> <span class="nn">rsrc</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos"> 5</span><span class="kn">from</span> <span class="nn">skdiveMove</span> <span class="kn">import</span> <span class="n">calibrate</span>
<span class="linenos"> 6</span><span class="kn">import</span> <span class="nn">skdiveMove.bouts</span> <span class="k">as</span> <span class="nn">skbouts</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1"># Declare figure sizes</span>
<span class="linenos"> 9</span><span class="n">_FIG1X1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="linenos">10</span><span class="n">_FIG1X2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="linenos">11</span><span class="n">_FIG3X1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
<section id="calculate-postdive-duration">
<h2>Calculate postdive duration<a class="headerlink" href="#calculate-postdive-duration" title="Link to this heading">#</a></h2>
<p>Create a <a class="reference internal" href="../modules/tdr.html#skdiveMove.TDR" title="skdiveMove.TDR"><code class="xref py py-class docutils literal notranslate"><span class="pre">TDR</span></code></a> object to easily calculate the necessary
statistics:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">17</span><span class="n">config_file</span> <span class="o">=</span> <span class="p">(</span><span class="n">rsrc</span><span class="o">.</span><span class="n">files</span><span class="p">(</span><span class="s2">&quot;skdiveMove&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;config_examples&quot;</span> <span class="o">/</span>
<span class="linenos">18</span>               <span class="s2">&quot;ag_mk7_2002_022_config.json&quot;</span><span class="p">)</span>
<span class="linenos">19</span><span class="n">tdr_file</span> <span class="o">=</span> <span class="p">(</span><span class="n">rsrc</span><span class="o">.</span><span class="n">files</span><span class="p">(</span><span class="s2">&quot;skdiveMove&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;tests&quot;</span> <span class="o">/</span>
<span class="linenos">20</span>            <span class="s2">&quot;data&quot;</span> <span class="o">/</span> <span class="s2">&quot;ag_mk7_2002_022.nc&quot;</span><span class="p">)</span>
<span class="linenos">21</span><span class="n">tdrX</span> <span class="o">=</span> <span class="n">calibrate</span><span class="p">(</span><span class="n">tdr_file</span><span class="p">,</span> <span class="n">config_file</span><span class="p">)</span>
<span class="linenos">22</span><span class="n">stats</span> <span class="o">=</span> <span class="n">tdrX</span><span class="o">.</span><span class="n">dive_stats</span><span class="p">()</span>
<span class="linenos">23</span><span class="n">stamps</span> <span class="o">=</span> <span class="n">tdrX</span><span class="o">.</span><span class="n">stamp_dives</span><span class="p">(</span><span class="n">ignore_z</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">24</span><span class="n">stats_tab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">stamps</span><span class="p">,</span> <span class="n">stats</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">25</span><span class="n">stats_tab</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 426 entries, 1 to 426
Data columns (total 49 columns):
 #   Column               Non-Null Count  Dtype          
---  ------               --------------  -----          
 0   phase_id             426 non-null    int64          
 1   beg                  426 non-null    datetime64[ns] 
 2   end                  426 non-null    datetime64[ns] 
 3   begdesc              426 non-null    datetime64[ns] 
 4   enddesc              426 non-null    datetime64[ns] 
 5   begasc               426 non-null    datetime64[ns] 
 6   desctim              426 non-null    float64        
 7   botttim              292 non-null    float64        
 8   asctim               426 non-null    float64        
 9   divetim              426 non-null    float64        
 10  descdist             426 non-null    float64        
 11  bottdist             292 non-null    float64        
 12  ascdist              426 non-null    float64        
 13  bottdep_mean         292 non-null    float64        
 14  bottdep_median       292 non-null    float64        
 15  bottdep_sd           292 non-null    float64        
 16  maxdep               426 non-null    float64        
 17  desc_tdist           199 non-null    float64        
 18  desc_mean_speed      199 non-null    float64        
 19  desc_angle           168 non-null    float64        
 20  bott_tdist           292 non-null    float64        
 21  bott_mean_speed      292 non-null    float64        
 22  asc_tdist            160 non-null    float64        
 23  asc_mean_speed       160 non-null    float64        
 24  asc_angle            154 non-null    float64        
 25  descD_mean           426 non-null    float64        
 26  descD_std            426 non-null    float64        
 27  descD_min            426 non-null    float64        
 28  descD_25%            426 non-null    float64        
 29  descD_50%            426 non-null    float64        
 30  descD_75%            426 non-null    float64        
 31  descD_max            426 non-null    float64        
 32  bottD_mean           292 non-null    float64        
 33  bottD_std            292 non-null    float64        
 34  bottD_min            292 non-null    float64        
 35  bottD_25%            292 non-null    float64        
 36  bottD_50%            292 non-null    float64        
 37  bottD_75%            292 non-null    float64        
 38  bottD_max            292 non-null    float64        
 39  ascD_mean            426 non-null    float64        
 40  ascD_std             425 non-null    float64        
 41  ascD_min             426 non-null    float64        
 42  ascD_25%             426 non-null    float64        
 43  ascD_50%             426 non-null    float64        
 44  ascD_75%             426 non-null    float64        
 45  ascD_max             426 non-null    float64        
 46  postdive_dur         426 non-null    timedelta64[ns]
 47  postdive_tdist       420 non-null    float64        
 48  postdive_mean_speed  420 non-null    float64        
dtypes: datetime64[ns](5), float64(42), int64(1), timedelta64[ns](1)
memory usage: 166.4 KB
</pre></div>
</div>
</div>
</div>
<p>Extract postdive duration for further analysis.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">26</span><span class="n">postdives</span> <span class="o">=</span> <span class="n">stats_tab</span><span class="p">[</span><span class="s2">&quot;postdive_dur&quot;</span><span class="p">][</span><span class="n">stats_tab</span><span class="p">[</span><span class="s2">&quot;phase_id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">]</span>
<span class="linenos">27</span><span class="n">postdives_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">postdives</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
<span class="linenos">28</span>                  <span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">abs</span><span class="p">())</span>
<span class="linenos">29</span><span class="c1"># Remove isolated dives</span>
<span class="linenos">30</span><span class="n">postdives_diff</span> <span class="o">=</span> <span class="n">postdives_diff</span><span class="p">[</span><span class="n">postdives_diff</span> <span class="o">&lt;</span> <span class="mi">2000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="non-linear-least-squares-via-broken-stick-model">
<h2>Non-linear least squares via “broken-stick” model<a class="headerlink" href="#non-linear-least-squares-via-broken-stick-model" title="Link to this heading">#</a></h2>
<p><cite>skdiveMove</cite> provides the <a class="reference internal" href="../modules/bouts.html#bouts.BoutsNLS" title="bouts.BoutsNLS"><code class="xref py py-class docutils literal notranslate"><span class="pre">bouts.BoutsNLS</span></code></a> class for fitting
non-linear least squares (NLS) models to a modified histogram of a given
variable.</p>
<p>The first step is to generate a modified histogram of postdive duration,
and this requires choosing the bin width for the histogram.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">31</span><span class="n">postdives_nlsbouts</span> <span class="o">=</span> <span class="n">skbouts</span><span class="o">.</span><span class="n">BoutsNLS</span><span class="p">(</span><span class="n">postdives_diff</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="linenos">32</span><span class="nb">print</span><span class="p">(</span><span class="n">postdives_nlsbouts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Class BoutsNLS object
histogram method:    standard
log-frequency histogram:
              x  lnfreq
count    46.000  46.000
mean    307.983  -4.079
std     383.530   2.119
min       0.050  -8.216
25%      62.550  -5.521
50%     132.550  -3.912
75%     351.300  -3.219
max    1449.950   3.091
</pre></div>
</div>
</div>
</div>
<section id="two-process-model">
<h3>Two-process model<a class="headerlink" href="#two-process-model" title="Link to this heading">#</a></h3>
<p>Assuming a 2-process model, calculate starting values, providing a guess at
50 s interdive interval.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">33</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">_FIG1X1</span><span class="p">)</span>
<span class="linenos">34</span><span class="n">init_pars2</span> <span class="o">=</span> <span class="n">postdives_nlsbouts</span><span class="o">.</span><span class="n">init_pars</span><span class="p">([</span><span class="mi">50</span><span class="p">],</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/demo_bouts_5_0.png" src="../_images/demo_bouts_5_0.png" />
</div>
</div>
<p>Fit the two-process model.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">35</span><span class="n">coefs2</span><span class="p">,</span> <span class="n">pcov2</span> <span class="o">=</span> <span class="n">postdives_nlsbouts</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">init_pars2</span><span class="p">)</span>
<span class="linenos">36</span><span class="c1"># Coefficients</span>
<span class="linenos">37</span><span class="nb">print</span><span class="p">(</span><span class="n">coefs2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>        (0.049, 50.0]  (50.0, 1449.95]
a              25.756            8.307
lambda          0.119            0.003
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">38</span><span class="c1"># Covariance between parameters</span>
<span class="linenos">39</span><span class="nb">print</span><span class="p">(</span><span class="n">pcov2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[+1.180e+02 +1.713e-01 +3.055e-01 +6.586e-05]
 [+1.713e-01 +8.032e-04 +6.607e-03 +1.584e-06]
 [+3.055e-01 +6.607e-03 +1.690e+00 +6.461e-05]
 [+6.586e-05 +1.584e-06 +6.461e-05 +1.542e-07]]
</pre></div>
</div>
</div>
</div>
<p>Calculate bout-ending criterion.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">40</span><span class="c1"># `bec` returns ndarray, and we have only one here</span>
<span class="linenos">41</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bec = {[0]:.2f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">postdives_nlsbouts</span><span class="o">.</span><span class="n">bec</span><span class="p">(</span><span class="n">coefs2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>bec = 41.70
</pre></div>
</div>
</div>
</div>
<p>Plot the fit.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">42</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">_FIG1X1</span><span class="p">)</span>
<span class="linenos">43</span><span class="n">postdives_nlsbouts</span><span class="o">.</span><span class="n">plot_fit</span><span class="p">(</span><span class="n">coefs2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/demo_bouts_9_0.png" src="../_images/demo_bouts_9_0.png" />
</div>
</div>
</section>
<section id="three-process-model">
<h3>Three-process model<a class="headerlink" href="#three-process-model" title="Link to this heading">#</a></h3>
<p>Attempt to discern three processes in the data.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">44</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">_FIG1X1</span><span class="p">)</span>
<span class="linenos">45</span><span class="n">init_pars3</span> <span class="o">=</span> <span class="n">postdives_nlsbouts</span><span class="o">.</span><span class="n">init_pars</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">550</span><span class="p">],</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/demo_bouts_10_0.png" src="../_images/demo_bouts_10_0.png" />
</div>
</div>
<p>Fit three-process model.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">46</span><span class="n">coefs3</span><span class="p">,</span> <span class="n">pcov3</span> <span class="o">=</span> <span class="n">postdives_nlsbouts</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">init_pars3</span><span class="p">)</span>
<span class="linenos">47</span><span class="c1"># Coefficients</span>
<span class="linenos">48</span><span class="nb">print</span><span class="p">(</span><span class="n">coefs3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>        (0.049, 50.0]  (50.0, 550.0]  (550.0, 1449.95]
a              29.812          7.094             3.913
lambda          0.254          0.014             0.001
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">49</span><span class="c1"># Covariance between parameters</span>
<span class="linenos">50</span><span class="nb">print</span><span class="p">(</span><span class="n">pcov3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[[+2.241e+02 +4.746e-01 -4.352e-01 -1.852e-03 -1.422e-01 -1.187e-04]
 [+4.746e-01 +6.365e-03 +3.179e-02 +9.877e-05 +6.796e-03 +5.591e-06]
 [-4.352e-01 +3.179e-02 +2.749e+00 +1.380e-03 -2.567e-01 -3.133e-04]
 [-1.852e-03 +9.877e-05 +1.380e-03 +2.145e-05 +2.135e-03 +1.889e-06]
 [-1.422e-01 +6.796e-03 -2.567e-01 +2.135e-03 +9.747e-01 +2.138e-04]
 [-1.187e-04 +5.591e-06 -3.133e-04 +1.889e-06 +2.138e-04 +5.340e-07]]
</pre></div>
</div>
</div>
</div>
<p>Plot the fit.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">51</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">_FIG1X1</span><span class="p">)</span>
<span class="linenos">52</span><span class="n">postdives_nlsbouts</span><span class="o">.</span><span class="n">plot_fit</span><span class="p">(</span><span class="n">coefs3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/demo_bouts_13_0.png" src="../_images/demo_bouts_13_0.png" />
</div>
</div>
<p>Compare the cumulative frequency distributions of two- vs three-process
models.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">53</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">_FIG1X2</span><span class="p">)</span>
<span class="linenos">54</span><span class="n">postdives_nlsbouts</span><span class="o">.</span><span class="n">plot_ecdf</span><span class="p">(</span><span class="n">coefs2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="linenos">55</span><span class="n">postdives_nlsbouts</span><span class="o">.</span><span class="n">plot_ecdf</span><span class="p">(</span><span class="n">coefs3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/demo_bouts_14_0.png" src="../_images/demo_bouts_14_0.png" />
</div>
</div>
<p>The three-process model does not follow the observed data as well as the
two-process model.</p>
</section>
</section>
<section id="maximum-likelihood-estimation">
<h2>Maximum likelihood estimation<a class="headerlink" href="#maximum-likelihood-estimation" title="Link to this heading">#</a></h2>
<p>Another way to model Poisson mixtures that does not rely on the
subjectively created histogram, and involves fewer parameters, requires
fitting via maximum likelihood estimation (MLE). This approach is available
in <a class="reference internal" href="../modules/bouts.html#bouts.BoutsMLE" title="bouts.BoutsMLE"><code class="xref py py-class docutils literal notranslate"><span class="pre">bouts.BoutsMLE</span></code></a>.</p>
<p>Set up an instance.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">56</span><span class="n">postdives_mlebouts</span> <span class="o">=</span> <span class="n">skbouts</span><span class="o">.</span><span class="n">BoutsMLE</span><span class="p">(</span><span class="n">postdives_diff</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="linenos">57</span><span class="nb">print</span><span class="p">(</span><span class="n">postdives_mlebouts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Class BoutsMLE object
histogram method:    standard
log-frequency histogram:
              x  lnfreq
count    46.000  46.000
mean    307.983  -4.079
std     383.530   2.119
min       0.050  -8.216
25%      62.550  -5.521
50%     132.550  -3.912
75%     351.300  -3.219
max    1449.950   3.091
</pre></div>
</div>
</div>
</div>
<p>Again, assuming a 2-process model, calculate starting values.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">58</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">_FIG1X1</span><span class="p">)</span>
<span class="linenos">59</span><span class="n">init_pars</span> <span class="o">=</span> <span class="n">postdives_mlebouts</span><span class="o">.</span><span class="n">init_pars</span><span class="p">([</span><span class="mi">50</span><span class="p">],</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/demo_bouts_16_0.png" src="../_images/demo_bouts_16_0.png" />
</div>
</div>
<p>Fit the two-process model.  It is important, but optional, to supply
reasonable bounds to help the optimization algorithm.  Otherwise, the
algorithm may fail to converge.  The fitting procedure is done in two
steps: with and without a reparameterized log-likelihood function.
Therefore, there are two sets of bounds required.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">60</span><span class="n">p_bnd</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>                 <span class="c1"># bounds for `p`</span>
<span class="linenos">61</span><span class="n">lda1_bnd</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>              <span class="c1"># bounds for `lambda1`</span>
<span class="linenos">62</span><span class="n">lda2_bnd</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>             <span class="c1"># bounds for `lambda2`</span>
<span class="linenos">63</span><span class="n">bnd1</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_bnd</span><span class="p">,</span> <span class="n">lda1_bnd</span><span class="p">,</span> <span class="n">lda2_bnd</span><span class="p">)</span>
<span class="linenos">64</span><span class="n">p_bnd</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="linenos">65</span><span class="n">lda1_bnd</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-4</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="linenos">66</span><span class="n">lda2_bnd</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="linenos">67</span><span class="n">bnd2</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_bnd</span><span class="p">,</span> <span class="n">lda1_bnd</span><span class="p">,</span> <span class="n">lda2_bnd</span><span class="p">)</span>
<span class="linenos">68</span><span class="n">fit1</span><span class="p">,</span> <span class="n">fit2</span> <span class="o">=</span> <span class="n">postdives_mlebouts</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">init_pars</span><span class="p">,</span>
<span class="linenos">69</span>                                    <span class="n">fit1_opts</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;L-BFGS-B&quot;</span><span class="p">,</span>
<span class="linenos">70</span>                                                   <span class="n">bounds</span><span class="o">=</span><span class="n">bnd1</span><span class="p">),</span>
<span class="linenos">71</span>                                    <span class="n">fit2_opts</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;L-BFGS-B&quot;</span><span class="p">,</span>
<span class="linenos">72</span>                                                   <span class="n">bounds</span><span class="o">=</span><span class="n">bnd2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">73</span><span class="c1"># First fit</span>
<span class="linenos">74</span><span class="nb">print</span><span class="p">(</span><span class="n">fit1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>  message: CONVERGENCE: REL_REDUCTION_OF_F_&lt;=_FACTR*EPSMCH
  success: True
   status: 0
      fun: 917.8524699057579
        x: [ 8.264e-01 -2.690e+00 -5.629e+00]
      nit: 7
      jac: [ 2.274e-04  9.095e-05  2.274e-04]
     nfev: 36
     njev: 9
 hess_inv: &lt;3x3 LbfgsInvHessProduct with dtype=float64&gt;
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">75</span><span class="c1"># Second fit</span>
<span class="linenos">76</span><span class="nb">print</span><span class="p">(</span><span class="n">fit2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>  message: ABNORMAL_TERMINATION_IN_LNSRCH
  success: False
   status: 2
      fun: 917.8524699057579
        x: [ 6.956e-01  6.791e-02  3.592e-03]
      nit: 0
      jac: [ 3.411e-04 -6.480e-04  3.683e-03]
     nfev: 68
     njev: 17
 hess_inv: &lt;3x3 LbfgsInvHessProduct with dtype=float64&gt;
</pre></div>
</div>
</div>
</div>
<p>Calculate bout-ending criterion (BEC).</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">77</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bec = </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">postdives_mlebouts</span><span class="o">.</span><span class="n">bec</span><span class="p">(</span><span class="n">fit2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>bec = 58.55
</pre></div>
</div>
</div>
</div>
<p>Plot the fit.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">78</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">_FIG1X1</span><span class="p">)</span>
<span class="linenos">79</span><span class="n">postdives_mlebouts</span><span class="o">.</span><span class="n">plot_fit</span><span class="p">(</span><span class="n">fit2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/demo_bouts_21_0.png" src="../_images/demo_bouts_21_0.png" />
</div>
</div>
<p>Compare the cumulative frequency distribution between NLS and MLE model
estimates.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">80</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">_FIG1X2</span><span class="p">)</span>
<span class="linenos">81</span><span class="n">postdives_nlsbouts</span><span class="o">.</span><span class="n">plot_ecdf</span><span class="p">(</span><span class="n">coefs2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="linenos">82</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;NLS&quot;</span><span class="p">)</span>
<span class="linenos">83</span><span class="n">postdives_mlebouts</span><span class="o">.</span><span class="n">plot_ecdf</span><span class="p">(</span><span class="n">fit2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="linenos">84</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;MLE&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/demo_bouts_22_0.png" src="../_images/demo_bouts_22_0.png" />
</div>
</div>
<p>Label bouts based on BEC from the last MLE model.  Note that <cite>Timedelta</cite>
type needs to be converted to total seconds to allow comparison with BEC.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos">85</span><span class="n">bec</span> <span class="o">=</span> <span class="n">postdives_mlebouts</span><span class="o">.</span><span class="n">bec</span><span class="p">(</span><span class="n">fit2</span><span class="p">)</span>
<span class="linenos">86</span><span class="n">skbouts</span><span class="o">.</span><span class="n">label_bouts</span><span class="p">(</span><span class="n">postdives</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">(),</span> <span class="n">bec</span><span class="p">,</span> <span class="n">as_diff</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>236     1
237     2
238     3
239     4
240     4
       ..
422    51
423    51
424    51
425    52
426    52
Name: postdive_dur, Length: 191, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Feel free to download a copy of this demo
(<a class="reference download internal" download="" href="../_downloads/614a5d5edc35630a6e0f3378b1e8dbdb/demo_bouts.py"><code class="xref download docutils literal notranslate"><span class="pre">demo_bouts.py</span></code></a>).</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="demo_tdr.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Diving behaviour analysis</p>
      </div>
    </a>
    <a class="right-next"
       href="demo_simulbouts.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Simulating bouts</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-postdive-duration">Calculate postdive duration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-linear-least-squares-via-broken-stick-model">Non-linear least squares via “broken-stick” model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-process-model">Two-process model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#three-process-model">Three-process model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-likelihood-estimation">Maximum likelihood estimation</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/demos/demo_bouts.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2020-2023, Sebastian Luque.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
  <p class="sphinx-version">
    scikit-diveMove icon inspired by B. Agustín Amenábar
    Larraín's <a href="https://thenounproject.com/browse/creator/agustin.amenabar/icons/?p=1">wave
    icon</a>  <br/>
  </p>
</div>
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>